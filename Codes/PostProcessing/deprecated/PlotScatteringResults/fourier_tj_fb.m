clear all; close all; clc;

% For pulsatileFlow

%% DATA

t = [
    10                                                                                                                                                                                          
10.08                                                                                                                                                                                       
10.16                                                                                                                                                                                       
10.24                                                                                                                                                                                       
10.32                                                                                                                                                                                       
10.4                                                                                                                                                                                        
10.48                                                                                                                                                                                       
10.56                                                                                                                                                                                       
10.64                                                                                                                                                                                       
10.72                                                                                                                                                                                       
10.8                                                                                                                                                                                        
10.88                                                                                                                                                                                       
10.96                                                                                                                                                                                       
11.04                                                                                                                                                                                       
11.12                                                                                                                                                                                       
11.2                                                                                                                                                                                        
11.28                                                                                                                                                                                       
11.36                                                                                                                                                                                       
11.44                                                                                                                                                                                       
11.52                                                                                                                                                                                       
11.6                                                                                                                                                                                        
11.68                                                                                                                                                                                       
11.76                                                                                                                                                                                       
11.84                                                                                                                                                                                       
11.92                                                                                                                                                                                       
12                                                                                                                                                                                          
12.08                                                                                                                                                                                       
12.16                                                                                                                                                                                       
12.24                                                                                                                                                                                       
12.32                                                                                                                                                                                       
12.4                                                                                                                                                                                        
12.48                                                                                                                                                                                       
12.56                                                                                                                                                                                       
12.64
12.72
12.8
12.88
12.96
13.04
13.12
13.2
13.28
13.36
13.44
13.52
13.6
13.68
13.76
13.84
13.92
14
14.08
14.16
14.24
14.32
14.4
14.48
14.56
14.64
14.72
14.8
14.88
14.96
15.04
15.12
15.2
15.28
15.36
15.44
15.52
15.6
15.68
15.76
15.84
15.92
16
16.08
16.16
16.24
16.32
16.4
16.48
16.56
16.64
16.72
16.8
16.88
16.96
17.04
17.12
17.2
17.28
17.36
17.44
17.52
17.6
17.68
17.76
17.84
17.92
18
18.08
18.16
18.24
18.32
18.4
20.24
];

C = [
     0.946674549359                                                                                                                                                                          
 0.975850741536                                                                                                                                                                          
 0.995903977874                                                                                                                                                                          
 0.931609590865                                                                                                                                                                          
 0.943814706925                                                                                                                                                                          
 0.971097963241                                                                                                                                                                          
 0.970111436254                                                                                                                                                                          
 0.980746149526                                                                                                                                                                          
 0.963760530513                                                                                                                                                                          
 0.941890979858                                                                                                                                                                          
 0.979915894746                                                                                                                                                                          
 0.967093663937                                                                                                                                                                          
 0.969934717055                                                                                                                                                                          
 0.965793262324                                                                                                                                                                          
 0.9700559879                                                                                                                                                                            
 0.977927695718                                                                                                                                                                          
 0.954346684704                                                                                                                                                                          
 0.979770288472                                                                                                                                                                          
 0.968077289245                                                                                                                                                                          
 0.977457076996                                                                                                                                                                          
 0.946964748898                                                                                                                                                                          
 0.978090561104                                                                                                                                                                          
 0.948294050912                                                                                                                                                                          
 0.978751586788                                                                                                                                                                          
 0.968811157838                                                                                                                                                                          
 0.988492576947                                                                                                                                                                          
 0.945832587975                                                                                                                                                                          
 0.968215464453                                                                                                                                                                          
 0.941025967748                                                                                                                                                                          
 1.00168597458                                                                                                                                                                           
 0.974745621956                                                                                                                                                                          
 0.93080516114                                                                                                                                                                           
 0.949988293461                                                                                                                                                                          
 0.971473917436
 0.989567925952
 0.983606431131
 0.970239134676
 0.957566417064
 0.985985578093
 0.984063698234
 0.962904551798
 0.964839779949
 0.965167978562
 0.969045502189
 0.947221604897
 0.991429292205
 0.949627406615
 0.956987176574
 0.980695886397
 0.956564483055
 0.976768208311
 1.01129360452
 0.937359509615
 0.997556843607
 0.975355520966
 0.957871655092
 0.976897156458
 0.96253426823
 0.966083336934
 0.96933762421
 0.991166005425
 0.996547048187
 0.971201207566
 0.95113267124
 0.982313111755
 0.949212647962
 0.985223676547
 0.977769041906
 0.934812691844
 0.961224667626
 1.00754194375
 0.975955346799
 1.00033136296
 0.97298430132
 0.977616346386
 0.9577934135
 0.991621772921
 0.953835060411
 0.954868005961
 0.976186525711
 0.979792779532
 0.980682906003
 0.983045388714
 0.954555644554
 0.954214162118
 0.946077000103
 0.950607423695
 0.985434762042
 0.978304223277
 0.970799889682
 0.97768919786
 0.999334600005
 0.984059213475
 0.973161362674
 0.954030166469
 0.984885391042
 0.9723306848
 0.97238649269
 0.949695991309
 0.971072434071
 1.01368957251
 0.985010279312
 0.955801356679
 0.962491065208
 0.991898580047
 0.961416032325
 0.979101574296
];

dt = 0.08;
fs = 1/dt;
cutoff = 101;

[T, I] = sort(t);

y = C(I)-mean(C(1:cutoff));

%% EigenFourier
omega = exp(-2*pi*j/cutoff);

for p = 0:cutoff-1
    som=0;
    for i = 0:cutoff-1
        som = som +(omega.^(i*p))*(y(i+1));
    end
    Y1(p+1) = som;
end

%% Fourier
y2 = y(1:cutoff);
T2 = T(1:cutoff);
Y = fft(y2);
f = fs/length(y2)*[0:length(y2)-1];

%% Plotting

figure
hold on
plot(T2,y2, 'Color', [0 166 214]./255);
ylabel('$C(t)-\langle C\rangle$ [-]','Interpreter','LaTeX','Fontsize',15)
xlabel('$t$ [s]','Interpreter','LaTeX','Fontsize',15)
hold off

set(gca, 'FontSize', 15)

figure
hold on
ylabel('$|\mathcal{F}\{C(t)\}|$ [a.u.]','Interpreter','LaTeX','Fontsize',15)
xlabel('$f$ [Hz]','Interpreter','LaTeX','Fontsize',15)
%stem(f, (abs(Y)/length(y2))/(max(abs(Y))/length(y2)),'o');
stem(f, abs(Y1), 'o', 'Color', [0 166 214]./255);
axis([0 12.4 ylim])
hold off

set(gca, 'FontSize', 15)